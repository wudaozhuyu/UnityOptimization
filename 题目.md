# c# 匿名函数的内存是如何分配的
* 当您在C#中创建匿名函数时，它将被编译成一个闭包（closure）。闭包将函数本身与函数作用域中的变量捆绑在一起，以便在其它地方调用函数时，变量状态不会丢失。因此，在内存中，闭包将包含函数的内部代码和它所使用的所有变量的状态。闭包会在您调用匿名函数时分配内存，并在函数调用结束时被释放。

# socket底层
* Socket是一种基于传输层协议的应用程序接口，它提供了一种标准化的方式，使得应用程序可以通过网络进行通信。
 在底层实现中，Socket通常使用TCP或UDP协议进行数据传输。TCP协议是面向连接的，它提供了可靠的数据传输机制，确保数据传输的顺序和完整性。UDP协议则是无连接的，它提供了一种快速的数据传输方式，但不保证数据传输的顺序和完整性。
 当建立一个Socket连接时，首先需要创建一个Socket对象。这个对象包含了一些基本的属性，如IP地址、端口号、传输协议等。然后，就需要使用Socket对象来连接另一个Socket对象，以建立起一条数据通道。
 在建立连接后，Socket对象可以使用不同的方法来进行数据的发送和接收。对于TCP连接，Socket通常使用输入输出流（InputStream和OutputStream）来进行数据的读写。对于UDP连接，Socket通常使用DatagramPacket和DatagramSocket对象来进行数据的传输。
 总之，Socket底层实现的核心是基于TCP或UDP协议的数据传输。它为应用程序提供了一种标准化的网络通信接口，使得开发者可以轻松地实现网络通信功能。

 ## 帧同步
 * 帧同步是一种多人在线游戏中常用的网络同步方式，其主要是指将游戏服务器和客户端之间的游戏状态进行同步。在帧同步模式下，服务器将游戏状态划分为若干个时间片，每个时间片称为一帧，服务器通过广播每一帧的状态信息给所有客户端，从而同步所有玩家的游戏状态。
 在帧同步中，需要同步的数据包括玩家的位置、朝向、状态、动作、攻击等游戏状态信息，同时还需要将玩家输入的指令同步给服务器，如移动、跳跃、攻击等，以保证服务器和客户端之间的游戏状态一致。
 此外，在帧同步中还需要对游戏状态进行压缩和优化，以减少网络传输的数据量，降低网络延迟和带宽占用。通常，服务器会对游戏状态进行预测，根据玩家的指令和当前的游戏状态估算未来的游戏状态，从而减少数据传输量，提高游戏的流畅度和稳定性。
 总之，帧同步主要同步的是玩家的游戏状态信息和输入指令，以保证所有玩家在同一时刻的游戏状态一致，从而实现多人在线游戏的正常运行。

 ## 状态同步
 * 状态同步是一种通过网络将游戏状态从服务器同步到客户端的技术。在状态同步中，服务器将游戏状态信息发送给客户端，以确保服务器和客户端之间的游戏状态保持一致。
 在状态同步中，需要同步的数据包括玩家的位置、状态、动作、朝向、血量、能量、装备等游戏状态信息。此外，还需要同步游戏世界中的其他实体信息，例如怪物的位置、状态、血量等。
 在实现状态同步时，通常采用一些优化技术，如状态压缩、状态预测等，以减少网络传输的数据量和延迟。例如，服务器可以对游戏状态进行预测，根据玩家的输入和当前的游戏状态估算未来的游戏状态，从而减少数据传输量，提高游戏的流畅度和稳定性。
 总之，状态同步主要同步游戏状态信息，以确保所有玩家在同一时刻的游戏状态保持一致，从而实现网络游戏的正常运行。

 ## 状态同步和帧同步区别
 * 状态同步和帧同步都是多人在线游戏中常用的网络同步方式，但是它们的实现方式和应用场景不同，具体区别如下：
 1. 同步方式不同
 状态同步是指将游戏状态从服务器同步到客户端，以确保服务器和客户端之间的游戏状态保持一致；而帧同步是将游戏状态划分为若干个时间片，每个时间片称为一帧，服务器通过广播每一帧的状态信息给所有客户端，从而同步所有玩家的游戏状态。
 2. 同步数据不同
 状态同步主要同步游戏状态信息，如玩家的位置、状态、血量等；而帧同步需要同步的数据除了游戏状态信息，还包括玩家的输入指令，如移动、攻击等。
 3. 应用场景不同
 状态同步适用于一些回合制和慢节奏的游戏，如策略游戏和角色扮演游戏，因为这些游戏的动作比较缓慢，可靠性要求较高，而且网络延迟对游戏影响不是很大。
 帧同步适用于一些动作类游戏，如射击游戏和竞技游戏，因为这些游戏的动作比较快速，玩家需要即时响应，所以网络延迟会对游戏影响较大，因此需要使用帧同步来保证游戏的流畅性和实时性。
 总之，状态同步和帧同步在多人在线游戏中扮演着不同的角色，并且都有其独特的应用场景。游戏开发者需要根据游戏的类型和玩家的需求来决定使用哪种同步方式。


